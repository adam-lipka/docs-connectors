= Salesforce - Design Center - Mule 4
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:imagesdir: ../../assets/images/

== Configure in Design Center

Create applications using the Salesforce connector. You can use an HTTP Listener, Scheduler, or the Salesforce connector as 
a trigger to initiate execution of the Mule flow. When changes occur in Salesforce, the Salesforce trigger starts the Mule flow to process the change. In addition, you can use a Salesforce operation to process the changes as a component.

. In Anypoint Platform > *Design Center*, click *Create* > *Mule Application*.
. In the first Mule Application card, if you want a Salesfore event to initiate access to your application (that is, to trigger your application), choose one of the Salesforce operations. Alternatively, you can use an *HTTP Listener* or *Scheduler* trigger.
+
Salesforce operations:
+
* *On Deleted Object* - Delete an object.
* *On Modified Object* - Modify an object.
* *On New Object* - Create a new object. Possible object types are Contact, Lead, Account, Contracts, Opportunity, and custom objects. The object types correspond to the Salesforce object you want to create, modify, or delete.
* *Replay Channel* - Subscribe to a streaming channel. This trigger provides channel-related notification settings for new events and events stored by Salesforce within the 24-hour retention period. Events that take place in the specified channel trigger the flow.
+
NOTE: A channel or topic must be published to Salesforce before a subscription to the channel can be created.
+
* *Replay Topic* - Subscribe to a topic. This trigger provides topic-related notification settings for new events and events stored by Salesforce within the 24-hour retention period. Events that take place on records in the specified topic trigger the flow.
* *Subscribe Channel* - Subscribe to a streaming channel. This trigger provides channel-related notification settings for new events that take place after you subscribe.
* *Subscribe Topic* - Subscribe to a topic. This trigger provides topic-related notification settings for new events that take place after you subscribe.

== New Object Trigger

The following shows how to configure the Salesforce New Object trigger.

. Create a New Mule Application in Design Center.
. Set the trigger. For example, you can use Salesforce > New Object.
. Click *Set up*.
. Specify the Connection Type:
+
[%header%autowidth.spread]
|===
|Connection Type |Salesforce Information Site
| <<Basic Username Password Authorization, Basic Username Password>> |https://developer.salesforce.com/docs/atlas.en-us.api.meta/api/sforce_api_calls_login.htm[SOAP API Username Password Login]
| <<OAuth 2.0 Authorization, OAuth 2.0>> |https://help.salesforce.com/articleView?id=remoteaccess_oauth_web_server_flow.htm[OAuth 2.0 Web Server Authorization Flow]
| <<OAuth JWT Authorization, OAuth JWT>> |https://help.salesforce.com/articleView?id=remoteaccess_oauth_jwt_flow.htm[OAuth 2.0 JWT Bearer Token Flow]
| <<OAuth SAML Authorization, OAuth SAML>> |https://help.salesforce.com/apex/HTViewHelpDoc?id=remoteaccess_oauth_SAML_bearer_flow.htm[OAuth 2.0 SAML Bearer Assertion Flow]
| <<OAuth Username Password Authorization, OAuth Username Password>> |https://help.salesforce.com/articleView?id=remoteaccess_oauth_username_password_flow.htm[OAuth 2.0 Username-Password Flow]
|===
+
NOTE: In version 9.6.0, OAuth 2.0 is listed as Deprecated. This connection type is not deprecated and you can ignore the `Deprecated` label. This was fixed in version 9.6.1 with the removal of the Deprecated label - the functionality didn't change, only its label.
+
. Specify the parameters as required for each configuration type, and click *Test* to ensure you have a valid connection to Salesforce.
. If needed, configure the *Apex* tab to decide what metadata to fetch and to add Apex class names.
. If you haven't specified a `Connection Type`, and if needed, configure the *Advanced* tab to set the `Max Idle Time` and `Time Units` for how long to hold open a connection before it expires.
. After you specify a connection type, if needed, you can use the *Advanced* tab to change values for the Reconnection Strategy, Pooling Profile, and Expiration Policy.
. If needed, set the `Redelivery Policy` on the main configuration screen. This indicates the maximum number of tries to deliver trigger content.

== Connector as a Component

After creating a trigger, click the plus sign. If needed, click *Transform* to use DataWeave to map fields between your received data and what to use with your Salesforce component.

The following are examples of the operations you can set in the Salesforce component:

*Create*:

* *Type*: Salesforce object type.
* *Records*: xref:design-center::function-editor-concept.adoc#to-use-the-function-editor[Function editor expression].

*Query*:

* *Salesforce query*: Salesforce query to retrieve objects.
* *Parameters*: Values for placeholders in the Salesforce query.

*Update*:

* *Type*: Salesforce object type.
* *Records*: xref:design-center::function-editor-concept.adoc[Function editor expression] to produce a collection of Salesforce objects to be updated.

*Delete*:

* *Records To Delete Ids*: xref:design-center::function-editor-concept.adoc[Function editor expression] to produce a collection of Salesforce objects to be deleted.

== Basic Username Password Authorization

Important fields:

* *Username* (required): Enter the Salesforce username.
* *Password* (required): Enter the corresponding password.
* *Security Token*: Enter the corresponding security token.

[NOTE]
Implementing OAuth 2.0-based authentication mechanisms involves extra steps, but may be preferred if your service is exposed to external users, as it ensures better security.

== OAuth 2.0 Authorization

Important fields:

* *Display* (required): How to optimize the display: `Page` = Full-page authorization screen (default), `Popup` = Compact dialog optimized for modern web browser popup windows, and `Touch` = Mobile-optimized dialog designed for modern smart phones, such as Android and iPhone.
* *Consumer Key* (required): The consumer key for the Salesforce connected app. See xref:salesforce-connector-config-topics.adoc#create-consumer-key[Create a Consumer Key].
* *Consumer Secret* (required): The consumer secret for the connector to access Salesforce.
* *Listener Config* (required): Configuration for the listener, for example, `HTTP_Listener_config`.
* *Callback Path* (required): Path for the callback, for example, `/callback`.
* *Authorize Path* (required): Path for authorization, for example, `/authorize`.
* *External Callback URL*: Callback URL, for example, `+http://localhost:8085/callback+`.

== OAuth JWT Authorization

Important fields:

* *Consumer Key* (required): The consumer key for the Salesforce connected app. See xref:salesforce-connector-config-topics.adoc#create-consumer-key[Create a Consumer Key].
* *Key Store* (required): The path to the key store used to sign data during authentication. Only Java key store format is allowed. See xref:salesforce-connector-config-topics.adoc#keystoregen[Generate a Keystore File].
* *Store Password* (required): The password for the keystore.
* *Principal* (required): The Salesforce username that you want to use.

== OAuth SAML Authorization

Important fields:

* *Consumer Key* (required): The consumer key for the Salesforce connected app. See xref:salesforce-connector-config-topics.adoc#create-consumer-key[Create a Consumer Key].
* *Key Store* (required): The path to the key store used to sign data during authentication. Only Java key store format is allowed. See xref:salesforce-connector-config-topics.adoc#keystoregen[Generate a Keystore File].
* *Store Password* (required): Key store password.
* *Principal* (required): Username of desired Salesforce user.

== OAuth Username Password Authorization

Important fields:

* *Consumer Key* (required): The consumer key for the Salesforce connected app. See xref:salesforce-connector-config-topics.adoc#create-consumer-key[Create a Consumer Key].
* *Consumer Secret* (required): The consumer secret for the connector to access Salesforce.
* *Username* (required): Enter the Salesforce username.
* *Password* (required): Enter the corresponding password.
* *Security token*: Enter the corresponding security token.

== See Also

* https://forums.mulesoft.com[MuleSoft Forum]
* https://support.mulesoft.com/s/knowledge[Knowledge Base Articles]
